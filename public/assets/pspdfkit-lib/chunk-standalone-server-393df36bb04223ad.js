/*!
 * PSPDFKit for Web 2024.5.0 (https://pspdfkit.com/web)
 *
 * Copyright (c) 2016-2024 PSPDFKit GmbH. All rights reserved.
 *
 * THIS SOURCE CODE AND ANY ACCOMPANYING DOCUMENTATION ARE PROTECTED BY INTERNATIONAL COPYRIGHT LAW
 * AND MAY NOT BE RESOLD OR REDISTRIBUTED. USAGE IS BOUND TO THE PSPDFKIT LICENSE AGREEMENT.
 * UNAUTHORIZED REPRODUCTION OR DISTRIBUTION IS SUBJECT TO CIVIL AND CRIMINAL PENALTIES.
 * This notice may not be removed from this file.
 *
 * PSPDFKit uses several open source third-party components: https://pspdfkit.com/acknowledgements/web/
 */
"use strict";(self.webpackChunkPSPDFKit=self.webpackChunkPSPDFKit||[]).push([[4267],{86528:(e,t,n)=>{n.d(t,{V:()=>r});var a=n(13798),i=n(33427),o=n(11765),s=n(21853);class r{constructor(e){this.ctx=e}renderTile(e,t,n,r,l,c){let d;c&&(d={annotations:c.annotations.filter(i.d).map(o.Hs).toJS().map((e=>({content:e}))),formFieldValues:c.formFieldValues.map(o.kr).toJS(),formFields:c.formFields.map(o.vD).toJS(),signatures:c.signatures||[],attachments:c.attachments});const u=a.f.Renderer.renderTile(this.ctx,e,t,n,{renderForPrinting:r,renderText:l,priority:t.width===n.width&&t.height===n.height?a.f.Priority.High:a.f.Priority.Normal},d).then((e=>(0,s.R9)({buffer:e.buffer,width:n.width,height:n.height,format:e.format}).then((e=>{if(null===e)throw new Error("Image handle is null");return e}))));return{promise:u.promise,cancel:u.cancel}}}},87460:(e,t,n)=>{n.d(t,{W:()=>m});var a=n(96156),i=n(35369),o=n(15359),s=n(45249),r=n(33427),l=n(60209),c=n(30006);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class m{constructor(){(0,a.Z)(this,"attachmentsCache",(0,i.D5)()),(0,a.Z)(this,"cachedAPStreams",(0,i.D5)()),(0,a.Z)(this,"pageAPStreamsPromises",(0,i.D5)()),(0,a.Z)(this,"annotationAPStreamPromises",(0,i.D5)()),(0,a.Z)(this,"_cachedRenderedAnnotation",null),(0,a.Z)(this,"_objectURLs",{}),(0,a.Z)(this,"_makeEnqueuedRelease",((e,t)=>{var n;if("IMG"===(null==e||null===(n=e.element)||void 0===n?void 0:n.tagName)){const n=e.element.src;if(!n)return;"number"==typeof this._objectURLs[n]?this._objectURLs[n]++:this._objectURLs[n]=1;const a=e.release;e.release=()=>{var e;(this._objectURLs[n]--,this._objectURLs[n]<=0)&&(null==a||a(),(null===(e=this._cachedRenderedAnnotation)||void 0===e?void 0:e.index)===t&&(this._cachedRenderedAnnotation=null),delete this._objectURLs[n])}}}))}getAnnotationFormFieldAndValue(e){var t;const n=this.provider;(0,o.kG)(n instanceof n.constructor,"Backend can only use backend annotation provider");const a=e instanceof s.x_?null===(t=n._readStateCallbacks)||void 0===t?void 0:t.getFormFieldByName(e.formFieldName):null;return{formField:a,formFieldValue:!a||a instanceof s.Yo?null:new s.KD({name:a.name,value:void 0!==a.formattedValue?a.formattedValue:"string"==typeof a.value?a.value:a.values})}}getAnnotationAvailableVariants(e){var t;const n=this.provider;(0,o.kG)(n instanceof n.constructor,"Backend can only use backend annotation provider");return[...(null===(t=n._readStateCallbacks)||void 0===t?void 0:t.getAvailableVariants(e))||[],"normal"]}cachedRenderAnnotation(e,t,n,a,i){const s=this.provider;(0,o.kG)(s instanceof s.constructor,"Backend can only use backend annotation provider");const{formField:l,formFieldValue:c}=this.getAnnotationFormFieldAndValue(e);if(!(0,r._R)(e,l))return this.renderAnnotation(e,c,t,n,a,i);const d=this.getAnnotationAvailableVariants(e);let m=!1,h=()=>{m=!0};return{promise:new Promise((async(o,s)=>{const r=t=>{const n=this.annotationAPStreamPromises.get(e.id);n&&(this.annotationAPStreamPromises=this.annotationAPStreamPromises.delete(e.id),n(t))},l=this.annotationAPStreamPromises.get(e.id);this.annotationAPStreamPromises=this.annotationAPStreamPromises.set(e.id,o),l&&l(null);try{const s=this.pageAPStreamsPromises.get(e.pageIndex);if(!s){const t=new Promise((t=>{this.annotationAPStreamPromises=this.annotationAPStreamPromises.set(e.id,t)}));return void o(await t)}await s;const l=this.cachedAPStreams.get(e.pageIndex);if(l){const t=l?l.get(e.id):null;if(t)return void r(this.getAPStream(t,i))}const{promise:p,cancel:f}=this.renderAPStream(e,c,t,n,a,d,i);if(m)r(null);else if(h=f,d.length>1){const t=await Promise.all(p.map((e=>e.promise)));r(t[d.indexOf(i||"normal")]),t.some(Boolean)&&this.cacheAPStream(d.reduce(((e,n,a)=>t[a]?u(u({},e),{},{[n]:t[a]}):e),{}),e)}else{const t=await p,n=t?this.getAPStream(t,i):null;r(n),n&&this.cacheAPStream(t,e)}}catch(e){s(e)}})),cancel:h}}cacheAPStream(e,t){let n=this.cachedAPStreams.get(t.pageIndex);n||(this.cachedAPStreams=this.cachedAPStreams.set(t.pageIndex,(0,i.D5)()),n=this.cachedAPStreams.get(t.pageIndex)),this.cachedAPStreams=this.cachedAPStreams.setIn([t.pageIndex,t.id],e)}clearAllPageAPStreams(e){const t=this.cachedAPStreams.get(e);t&&(t.forEach((e=>{this.releaseAPStream(e)})),this.cachedAPStreams=this.cachedAPStreams.delete(e)),this.pageAPStreamsPromises=this.pageAPStreamsPromises.delete(e)}clearPageAPStreams(e,t){const n=this.cachedAPStreams.get(e);n&&(n.filter(((e,n)=>t.has(n))).forEach((e=>{this.releaseAPStream(e)})),this.cachedAPStreams=this.cachedAPStreams.updateIn([e],(e=>e.filter(((e,n)=>!t.has(n))))))}getAPStream(e,t){return e instanceof l.Z?e:(null==e?void 0:e[t||"normal"])||null}renderAPStream(e,t,n,a,i,o,s){if(o.length>1){const s=o.map((o=>this.renderAnnotation(e,t,n,a,i,"normal"!==o?o:void 0)));return{promise:s,cancel:()=>{s.forEach((e=>{e.cancel()}))}}}return this.renderAnnotation(e,t,n,a,i,s)}releaseAPStream(e){e instanceof l.Z?e.release():Object.values(e).forEach((e=>{e.release()}))}isVisuallyIdenticalStampAnnotationCached(e){let{annotation:t,width:n,height:a}=e;const i=(0,r.et)(t);return!!this._cachedRenderedAnnotation&&(0,c.Gx)({annotation:t,annotationVisualPropertiesString:i,width:n,height:a,secondAnnotationVisualPropertiesString:this._cachedRenderedAnnotation.index,secondAnnotationWidth:this._cachedRenderedAnnotation.width,secondAnnotationHeight:this._cachedRenderedAnnotation.height})}cachedStampAnnotationDiscardablePromise(e){let{promise:t,resolve:n,reject:a}=e;(0,o.kG)(this._cachedRenderedAnnotation);const i=this._cachedRenderedAnnotation.index;return this._cachedRenderedAnnotation.APStreamPromise.then((e=>{let t;e&&(t=new l.Z(e.element.cloneNode(!0),e.release),this._makeEnqueuedRelease(t,i)),n(t)})).catch(a),{promise:t,cancel:()=>{}}}}},42153:(e,t,n)=>{n.d(t,{m:()=>ce,ZP:()=>de,oc:()=>ue,MO:()=>me});var a=n(17375),i=n(96156),o=n(35369),s=n(75472),r=n(15359),l=n(51679),c=n(34997),d=n(19575),u=n(13798),m=n(72110),h=n(69847),p=n(21853),f=n(7407),g=n(33427),y=n(87460),b=n(65160),v=n(10983),P=n(84254),k=n(11765),S=n(67366),A=n(88133),_=n(56573),F=n(22284),w=n(24382);const O=["rollover","down"];function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class D extends((0,o.WV)({alreadyLoadedPages:(0,o.D5)(),isLoaded:!1,isDestroyed:!1})){}const x={skippedPdfObjectIds:[],skippedPdfBookmarkIds:[],annotations:[],bookmarks:[],formFieldValues:[],formFields:[],attachments:{}};class j{constructor(e,t){(0,i.Z)(this,"_state",new D),(0,i.Z)(this,"_formFieldsLoadedPromise",null),(0,i.Z)(this,"_objectCreationPromises",(0,o.D5)()),(0,i.Z)(this,"_loadBookmarksPromise",null),(0,i.Z)(this,"_commentsLoadedPromise",null),(0,i.Z)(this,"canCreateBackendOrphanWidgets",!1),(0,i.Z)(this,"updateTabOrderTimeout",null),(0,i.Z)(this,"pagesTabOrderToUpdate",(0,o.l4)()),this._core=e,this._json=t?(0,r.H7)(t):null,this._setReadStateCallbacksPromise=new Promise((e=>{this._setReadStateCallbacksPromiseResolve=e}))}async load(){if(this._state=this._state.set("isLoaded",!0),!this._formFieldCallbacks&&await this._loadFormFieldValues(),!this._json)return this;await this._core.importInstantJSON(I(I({},x),this._json)),(0,r.kG)(this._json);const{annotations:e,attachments:t}=this._json;if(this._isDestroyed()||!t||0===Object.entries(t).length)return this;if(e)for(let n=0;n<e.length;n++){let a=null;const i=e[n];if("imageAttachmentId"in i&&i.imageAttachmentId){const e=t?t[i.imageAttachmentId]:null;if(e)try{a=(0,_.Jc)(atob(e.binary),e.contentType),(0,r.kG)(this._annotationCallbacks),this._annotationCallbacks.createAttachment(i.imageAttachmentId,a)}catch(e){(0,r.um)(`Skipped attachment with id ${i.imageAttachmentId} from payload because an error occurred while converting the binary image to blob.`),(0,r.um)(e)}}}return this}destroy(){this._state=this._state.set("isDestroyed",!0),this._annotationCallbacks=null,this._readStateCallbacks=null,this._bookmarkCallbacks=null,this._formFieldCallbacks=null,this._formFieldValueCallbacks=null,this._commentCallbacks=null}setReadStateCallbacks(e){var t;this._readStateCallbacks=e,null===(t=this._setReadStateCallbacksPromiseResolve)||void 0===t||t.call(this)}setAnnotationCallbacks(e){this._annotationCallbacks=e}setBookmarkCallbacks(e){this._bookmarkCallbacks=e}setFormFieldCallbacks(e){this._formFieldCallbacks=e}setFormFieldValueCallbacks(e){this._formFieldValueCallbacks=e}setCommentCallbacks(e){this._commentCallbacks=e}createComment(e,t,n){return this._core.applyComments(t.map((e=>E(e,n))).toArray())}updateComment(e,t,n){return this._core.applyComments(t.map((e=>E(e,n))).toArray())}deleteComment(e,t,n){return this._core.applyComments(t.map((e=>E(e,n))).toArray())}async loadComments(){return this._commentsLoadedPromise||(this._commentsLoadedPromise=this._loadComments()),this._commentsLoadedPromise}async _loadComments(){var e,t;this._verifyLoaded();const n=null!==(e=await this._core.getComments())&&void 0!==e?e:[],a=(0,o.aV)(n.map((e=>{let t;var n;e.pdfObjectId?t=e.id||(null===(n=e.pdfObjectId)||void 0===n?void 0:n.toString()):t=(0,g.xc)();return(0,k.Mu)(t,e)})));await Promise.all(a.map((e=>"number"==typeof e.pageIndex&&this.loadAnnotationsForPageIndex(e.pageIndex))).filter(Boolean).toArray()),null===(t=this._commentCallbacks)||void 0===t||t.createComments(a,w.y),this._commentsLoadedPromise=Promise.resolve()}async updateTabOrder(e){this.pagesTabOrderToUpdate=this.pagesTabOrderToUpdate.add(e),this.updateTabOrderTimeout&&clearTimeout(this.updateTabOrderTimeout),this.updateTabOrderTimeout=setTimeout((async()=>{const e=this.pagesTabOrderToUpdate.toArray();if(this.pagesTabOrderToUpdate=(0,o.l4)(),this._isDestroyed())return;const t=await Promise.all(e.map((e=>this._core.getTabOrder(e))));this._isDestroyed()||((0,r.kG)(this._annotationCallbacks),(0,S.dC)((()=>{e.forEach(((e,n)=>{var a;null===(a=this._annotationCallbacks)||void 0===a||a.setPageTabOrder(e,t[n])}))})))}),1e3)}async setTabOrder(e,t){return this._core.setTabOrder(e,t)}async createAnnotation(e,t){this._verifyLoaded();const n=t.find(((t,n)=>((0,r.kG)("imageAttachmentId"in e,"Annotation must have imageAttachmentId."),n===e.imageAttachmentId))),a=await this._core.createAnnotation((0,k.Hs)(e),n?n.data:null);"number"!=typeof a||"number"!=typeof e.pdfObjectId||e.pdfObjectId===a||this._isDestroyed()||((0,r.kG)(this._annotationCallbacks),this._annotationCallbacks.updateAnnotations((0,o.aV)([e.set("pdfObjectId",a)]))),await this.updateTabOrder(e.pageIndex)}async updateAnnotation(e){this._verifyLoaded(),await this._core.updateAnnotation((0,k.Hs)(e)),await this.updateTabOrder(e.pageIndex)}deleteAnnotation(e){return this._verifyLoaded(),this._core.deleteAnnotation((0,k.Hs)(e))}createBookmark(e){return this._verifyLoaded(),this._core.createBookmark((0,A.a)(e))}updateBookmark(e){return this._verifyLoaded(),this._core.updateBookmark((0,A.a)(e))}deleteBookmark(e){return this._verifyLoaded(),this._core.deleteBookmark(e)}createFormField(e){this._verifyLoaded(),(0,r.kG)(this._readStateCallbacks);const t=this._readStateCallbacks.getFormFieldWidgets(e);return this._core.createFormField((0,k.vD)(e),t.map((e=>(0,k.Hs)(e))).toArray()).then((async e=>{(0,S.dC)((()=>{e.forEach(((e,n)=>{const a=t.get(n);(0,r.kG)(a),(0,r.kG)(this._annotationCallbacks),"number"!=typeof e||"number"!=typeof a.pdfObjectId||a.pdfObjectId===e||this._isDestroyed()||this._annotationCallbacks.updateAnnotations((0,o.aV)([a.set("pdfObjectId",e)]))}))}))}))}updateFormField(e){this._verifyLoaded(),(0,r.kG)(this._readStateCallbacks);const t=this._readStateCallbacks.getFormFieldWidgets(e);return this._core.updateFormField((0,k.vD)(e),t.map((e=>(0,k.Hs)(e))).toArray())}deleteFormField(e){return this._verifyLoaded(),this._core.deleteFormField((0,k.vD)(e))}loadFormFields(){return this._formFieldsLoadedPromise||(this._formFieldsLoadedPromise=this._loadFormFields()),this._formFieldsLoadedPromise}async _loadFormFields(){this._verifyLoaded();const e=await this._core.readFormJSONObjects();if(this._isDestroyed())return;let t=(0,o.aV)(),n=(0,o.aV)().withMutations((n=>{e.forEach((e=>{const{formField:a,widgets:i,value:o}=e;try{let e;e=a.pdfObjectId?a.pdfObjectId.toString():(0,g.xc)();const s=(0,k.IN)(e,a);(0,r.kG)(this._readStateCallbacks),this._readStateCallbacks.isFormFieldInState(s.name)||n.push(s.set("value",o)),i.forEach((e=>{let n;n=e.pdfObjectId?e.id||e.pdfObjectId.toString():(0,g.xc)(),(0,r.kG)(this._readStateCallbacks),t=t.push((0,k.vH)(n,e))}))}catch(e){(0,r.um)(`Skipped creating form field #${a.pdfObjectId} from payload because an error occurred while deserializing.`),(0,r.um)(e)}}))}));const a={},i={};t.forEach((e=>{i[e.id]||(i[e.id]=[]),i[e.id].push(e.pdfObjectId)})),t=t.map((e=>{var t,o;if(i[e.id].filter((t=>t!==e.pdfObjectId)).length>0&&(null===(t=e.pdfObjectId)||void 0===t?void 0:t.toString())!==e.id||null!==(o=this._readStateCallbacks)&&void 0!==o&&o.isAnnotationInState(e.id)){const t=(0,g.xc)();return a[e.formFieldName]?a[e.formFieldName].push({[e.id]:t}):a[e.formFieldName]=[{[e.id]:t}],n=n.map((n=>n.name===e.formFieldName?n.update("annotationIds",(n=>null==n?void 0:n.map((n=>n===e.id?t:n)))):n)),e.set("id",t)}return e})),Object.keys(a).forEach((e=>{const a=n.find((t=>t.name===e));(0,r.kG)(a);const i=t.filter((t=>t.formFieldName===e)).toArray().map((e=>(0,k.Hs)(e)));this._core.updateFormField((0,k.vD)(a),i)})),n.size>0&&!this._isDestroyed()&&((0,r.kG)(this._formFieldCallbacks),this._formFieldCallbacks.createFormFields(n,w.y)),await this._loadFormFieldValues(),t.size>0&&!this._isDestroyed()&&((0,r.kG)(this._annotationCallbacks),this._annotationCallbacks.createAnnotations(t,(0,o.D5)(),w.y)),this._formFieldsLoadedPromise=Promise.resolve()}createFormFieldValue(e){return this._verifyLoaded(),this.setFormFieldValue(e)}setFormFieldValue(e){return this._verifyLoaded(),this._core.setFormFieldValue((0,k.kr)(e))}deleteFormFieldValue(e){return this._verifyLoaded(),this._core.deleteFormFieldValue(e.replace("form-field-value/",""))}loadAnnotationsForPageIndex(e){const t=this._state.alreadyLoadedPages.get(e);if(t)return t;const n=this._loadAnnotationsForPageIndex(e);return this._state=this._state.setIn(["alreadyLoadedPages",e],n),n}async _loadAnnotationsForPageIndex(e){this._verifyLoaded();const[t,n]=await Promise.all([this._core.annotationsForPageIndex(e),this._core.getTabOrder(e)]);if(this._isDestroyed())return;const i=[],s=[],l=t.map((e=>{let{rollover:t,down:n}=e,o=(0,a.Z)(e,O);return t&&"number"==typeof o.pdfObjectId&&i.push(o.pdfObjectId),n&&"number"==typeof o.pdfObjectId&&s.push(o.pdfObjectId),o})).filter((e=>"number"==typeof e.pageIndex));this._formFieldCallbacks&&await this.loadFormFields();const c=(0,o.aV)().withMutations((e=>{l.filter((e=>!e.id||this._readStateCallbacks&&!this._readStateCallbacks.isAnnotationInState(e.id))).forEach((t=>{t.pdfObjectId;try{var n;let a;a=function(e){return"pspdfkit/link"===e.type&&0===e.pdfObjectId}(t)?t.id||(0,g.xc)():t.id||t.pdfObjectId.toString(),(e.some((e=>e.id===a))||null!==(n=this._readStateCallbacks)&&void 0!==n&&n.isAnnotationInState(a))&&(a=(0,g.xc)(),t.id=a,this._core.updateAnnotation(t));const i=(0,k.vH)(a,t);e.push(i)}catch(e){(0,r.um)(`Skipped creating annotation #${t.pdfObjectId} from payload because an error occurred while deserializing.`),(0,r.um)(e)}}))}));(0,S.dC)((()=>{(0,r.kG)(this._annotationCallbacks),c.size>0&&this._annotationCallbacks.createAnnotations(c,(0,o.D5)(),w.y),this._annotationCallbacks.setPageTabOrder(e,n),i.length>0&&this._annotationCallbacks.addAnnotationVariants("rollover",i),s.length>0&&this._annotationCallbacks.addAnnotationVariants("down",s)})),this._state=this._state.setIn(["alreadyLoadedPages",e],Promise.resolve())}async _loadFormFieldValues(){this._verifyLoaded();const e=await this._core.getFormValues();if(this._isDestroyed())return;const t=(0,o.aV)().withMutations((t=>{e.forEach((e=>{try{t.push((0,k.u9)(e))}catch(t){(0,r.um)(`Skipped creating form field value #${e.pdfObjectId} from payload because an error occurred while deserializing.`),(0,r.um)(t)}}))}));t.size>0&&!this._isDestroyed()&&((0,r.kG)(this._formFieldValueCallbacks),this._formFieldValueCallbacks.setFormFieldValues(t))}async loadBookmarks(){this._verifyLoaded();const e=await this._core.getBookmarks();if(this._isDestroyed())return;const t=(0,o.aV)().withMutations((t=>{e.forEach((e=>{let n;n=e.id?e.id:e.pdfBookmarkId?e.pdfBookmarkId:(0,F.A)();try{t.push((0,A.i)(n,e))}catch(e){(0,r.um)(`Skipped creating bookmark #${n} from payload because an error occurred while deserializing.`),(0,r.um)(e)}}))}));t.size>0&&!this._isDestroyed()&&((0,r.kG)(this._bookmarkCallbacks),this._bookmarkCallbacks.createBookmarks(t,w.y))}_verifyLoaded(){(0,r.kG)(this._state.isLoaded,"StandaloneProvider not properly initialized.")}_isDestroyed(){return this._state.isDestroyed}async syncChanges(){}}function E(e,t){var n;(0,r.kG)(e.rootId,"A new comment must have `rootId` present");const a=t.get(e.rootId);return(0,r.kG)(a,"An annotation must be present linked to the comment to create"),(0,k.jA)(e,(null===(n=a.pdfObjectId)||void 0===n?void 0:n.toString())===a.id?parseInt(e.rootId):e.rootId)}class L{constructor(e,t){this.identifier=e,this.callback=t}request(){return this.callback()}}var R=n(78025),T=n(20063);class G extends(o.WV({baseUrl:null,baseCoreUrl:null,baseProcessorEngineUrl:null,licenseKey:null,document:null,backendPermissions:new R.Z,documentResponse:null,disableWebAssemblyStreaming:!1,enableAutomaticLinkExtraction:!1,overrideMemoryLimit:null,features:(0,o.aV)(),signatureFeatureAvailability:T.H.NONE,documentHandle:null,trustedCAsCallback:null,signaturesInfoPromise:null,customFonts:null,fontSubstitutions:null,forceLegacySignaturesFeature:!1,forceAnnotationsRender:!1,appName:null,lazyLoadedPages:null,productId:null,processorEngine:null,dynamicFonts:null,inlineWorkers:!0})){}var B=n(67009),V=n(43069),N=n(36691),U=n(88265),M=n(94732),W=n(94809),Z=n(98492),K=n(96650),z=n(87856),H=n(2282),J=n(67055),q=n(45249),$=n(44550),X=n(33383),Y=n(74311),Q=n(74110),ee=n(15650),te=n(31312),ne=n(44077),ae=n(86528),ie=n(46364);const oe=["id"];function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let le;le=n(75472).AO;const ce=new s.L7(le);class de extends y.W{constructor(e){super(),(0,i.Z)(this,"type","STANDALONE"),(0,i.Z)(this,"_XFDF",null),me(e);const{baseUrl:t,baseCoreUrl:n,baseProcessorEngineUrl:a,instantJSON:o,XFDF:s,enableAutomaticLinkExtraction:r,overrideMemoryLimit:c,trustedCAsCallback:d,electronAppName:m,appName:h,isSharePoint:p,isSalesforce:f,productId:g,processorEngine:y,dynamicFonts:b,inlineWorkers:P}=e;"string"==typeof s&&(this._XFDF={source:s,keepCurrentAnnotations:!0===e.XFDFKeepCurrentAnnotations,ignorePageRotation:!0===e.XFDFIgnorePageRotation}),o&&o.annotations&&(o.annotations=o.annotations.map((e=>{var t;return e.id=null===(t=e.id)||void 0===t?void 0:t.toString(),e}))),this._instantJSON=o,"function"==typeof d&&(this._trustedCAsCallback=d);const{disableWebAssemblyStreaming:k,customFonts:S,fontSubstitutions:A}=e,{standaloneInstancesPoolSize:_}=e;void 0!==_&&(ce.size=_);const F=!!e.electronicSignatures&&Boolean(e.electronicSignatures.forceLegacySignaturesFeature);let w=g||null;!p&&!f||w||(w=p?X.x.SharePoint:X.x.Salesforce),this._state=new G(ue({baseUrl:t,baseCoreUrl:n,baseProcessorEngineUrl:a,licenseKey:e.licenseKey,document:e.document,disableWebAssemblyStreaming:k,enableAutomaticLinkExtraction:r,overrideMemoryLimit:c,documentHandle:"0",customFonts:S,fontSubstitutions:A,forceLegacySignaturesFeature:F,appName:h||m,productId:w,processorEngine:y||ee.l.fasterProcessing,dynamicFonts:b,inlineWorkers:P})),this._requestQueue=new l.g(v.gZ);const{object:O,checkIn:C}=ce.checkOut();this.client=O,this.checkIn=C,this.corePDFBridge=new ae.V(u.f.createWASMContext(this.client));const I=o?re({annotations:o.annotations||[],formFields:o.formFields||[],formFieldValues:o.formFieldValues||[],skippedPdfObjectIds:o.skippedPdfObjectIds||[],skippedPdfFormFieldIds:o.skippedPdfFormFieldIds||[],attachments:o.attachments||{},bookmarks:o.bookmarks||[],skippedPdfBookmarkIds:o.skippedPdfBookmarkIds||[],comments:o.comments||void 0,skippedComments:o.skippedComments||void 0,format:o.format},o.pdfId?{pdfId:o.pdfId}:null):null;this.provider=new j(this.client,I)}isUsingInstantProvider(){return!1}hasClientsPresence(){return!1}async load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isPDFJavaScriptEnabled=e.isPDFJavaScriptEnabled,{features:this._state.features,signatureFeatureAvailability:this._state.signatureFeatureAvailability,hasPassword:!!e.password,allowedTileScales:"all"}}destroy(){this.provider&&this.provider.destroy(),this._requestQueue&&this._requestQueue.destroy(),this.checkIn()}async documentInfo(){return this._state.documentResponse}async lazyLoadPages(){if(!this._state.lazyLoadedPages){const e=await this.client.getAllPageInfos(this._state.documentResponse.pageCount);this._state=this._state.set("lazyLoadedPages",e)}return this._state.lazyLoadedPages}getDocumentHandle(){return this._state.documentHandle}getFormJSON(){return this.client.getFormJSON()}permissions(){return Promise.resolve(this._state.backendPermissions)}textForPageIndex(e){let t=!1;const n=new L(`${e}-text`,(()=>t?Promise.reject({aborted:!0}):this.client.textForPageIndex(e).then((n=>t?Promise.reject({aborted:!0}):(0,b.TH)({textLines:n},e))))),{promise:a,cancel:i}=this._requestQueue.enqueue(n);return{promise:a,cancel:()=>{t=!0,i()}}}getContentTreeForPageIndex(e){let t=!1;const n=new L(`${e}-text`,(()=>t?Promise.reject({aborted:!0}):this.client.contentTreeForPageIndex(e).then((t=>{let n=[],a=0,i=0;return n=t.reduce(((t,n)=>{let{nodes:o}=n;const s=(0,b.uv)(o,e,t.length,a,i);return a+=s.reduce(((e,t)=>{let{textLines:n}=t;return e+n.size}),0),i+=s.reduce(((e,t)=>{let{contentElements:n}=t;return e+n.size}),0),t.concat(s)}),[]),(0,o.aV)(n)})))),{promise:a,cancel:i}=this._requestQueue.enqueue(n);return{promise:a,cancel:()=>{t=!0,i()}}}getTextFromRects(e,t){return this.client.getTextFromRects(e,t.toJS())}getAvailableFontFaces(e){return this.client.getAvailableFontFaces(e)}async getSuggestedLineHeightFactor(e){return"number"!=typeof e.pdfObjectId?1:"number"!=typeof e.pageIndex?((0,r.ZK)("Annotation must have a pageIndex."),1):(e.lineHeightFactor&&(0,r.ZK)(`Annotation ${e.id} already has a line height factor.`),this.client.getSuggestedLineHeightFactor(e.pdfObjectId,e.pageIndex))}async getClosestSnapPoint(e){const t=await this.client.getClosestSnapPoint(e.x,e.y);return t&&"number"==typeof t[0]&&"number"==typeof t[1]?new ne.E9({x:t[0],y:t[1]}):e}configureSnapper(e){return this.client.configureSnapper(e)}renderAnnotation(e,t,n,a,i,o){if(0===Math.floor(a)||0===Math.floor(i))return{promise:Promise.resolve(void 0),cancel:()=>{}};const s=(0,ie.d6)();if(e instanceof q.GI){if(this.isVisuallyIdenticalStampAnnotationCached({annotation:e,width:a,height:i}))return this.cachedStampAnnotationDiscardablePromise(s);(0,g.eD)(e)||(this._cachedRenderedAnnotation={index:(0,g.et)(e),width:a,height:i,APStreamPromise:s.promise})}const r=e.id,l=new L(r,(()=>this.client.renderAnnotation((0,k.Hs)(e),n,a,i,(0,z.zP)(),o).then((e=>e?"string"==typeof e?(0,p.ar)(e):(0,p.R9)({buffer:e,width:a,height:i}):Promise.resolve(null))).then((t=>(e instanceof q.GI&&this._makeEnqueuedRelease(t,(0,g.et)(e)),s.resolve(t),t)))));return this._requestQueue.enqueue(l,!1)}async getMeasurementSnappingPoints(e){return this.client.getMeasurementSnappingPoints(e)}async getSecondaryMeasurementUnit(){return await this.client.getSecondaryMeasurementUnit()}async setSecondaryMeasurementUnit(e){return await this.client.setSecondaryMeasurementUnit(e)}async compareDocuments(e,t){const n={originalDocument:e.originalDocument,changedDocument:e.changedDocument,comparisonOperation:(0,h.j)(t)};return await this.client.compareDocuments(n)}async renderPageAnnotations(e,t,n){const a=this.provider,i=[],o=[],s=t.some((e=>e instanceof q.x_));s&&await a._setReadStateCallbacksPromise;const r=t.filter((e=>{const t=s?a._readStateCallbacks.getAnnotationWithFormField(e.id):null,n=null==t?void 0:t.formField,r=(0,g._R)(e,n);if(r&&n){i.find((e=>e.name===n.name))||(i.push((0,k.kr)((0,V.CH)(n))),o.push(n))}return r}));function l(e,t){if(null!=e&&e.formFieldName){const n=o.find((t=>t.name===e.formFieldName)),a=t.find((t=>t.name===e.formFieldName));if(!(0,V.BT)(n,a))return!1}return!0}const c=new Promise(((t,i)=>{const s=r.filter((e=>0!==Math.floor(e.boundingBox.width*n)&&0!==Math.floor(e.boundingBox.height*n)));this.client.renderPageAnnotations(e,s.map((e=>e.pdfObjectId)).toArray(),s.map((e=>e.boundingBox.width*n)).toArray(),s.map((e=>e.boundingBox.height*n)).toArray(),(0,z.zP)()).then((e=>{const i=o.map((e=>{var t;return null===(t=a._readStateCallbacks)||void 0===t?void 0:t.getFormFieldByName(e.name)})).filter(Boolean),r=e.map(((e,t)=>{const a=s.get(t);return l(a,i)&&a&&e?"string"==typeof e?(0,p.ar)(e):(0,p.R9)({buffer:e,width:a.boundingBox.width*n,height:a.boundingBox.height*n}):Promise.resolve(null)}));Promise.all(r).then((e=>{const i=o.map((e=>{var t;return null===(t=a._readStateCallbacks)||void 0===t?void 0:t.getFormFieldByName(e.name)})).filter(Boolean);e.forEach(((e,t)=>{const a=s.get(t);if(a){const{formFieldValue:t}=this.getAnnotationFormFieldAndValue(a),o=this.getAnnotationAvailableVariants(a),s=this.annotationAPStreamPromises.get(a.id),r=l(a,i);if(s&&(this.annotationAPStreamPromises=this.annotationAPStreamPromises.delete(a.id),s(r?e:null)),o.length>1){const i={normal:e};e&&r&&this.cacheAPStream(i,a);const{promise:s}=this.renderAPStream(a,t,null,a.boundingBox.width*n,a.boundingBox.height*n,o);Promise.all(s.map((e=>e.promise))).then((e=>{e.some(Boolean)&&o.forEach(((t,n)=>{"normal"!==t&&e[n]&&(i[t]=e[n])}))}))}else e&&r&&this.cacheAPStream(e,a)}})),t()}))})).catch(i)}));return this.pageAPStreamsPromises=this.pageAPStreamsPromises.set(e,c),c}renderDetachedAnnotation(e,t,n,a){if(e.id)throw new r.p2(`Detached annotations should not have an \`id\`: ${e.id}`);const i=(0,ie.d6)();if(e instanceof q.GI){if(this.isVisuallyIdenticalStampAnnotationCached({annotation:e,width:n,height:a}))return this.cachedStampAnnotationDiscardablePromise(i);(0,g.eD)(e)||(this._cachedRenderedAnnotation={index:(0,g.et)(e),width:n,height:a,APStreamPromise:i.promise})}const o=(0,c.SK)(),s=new L(o,(()=>this.client.renderDetachedAnnotation((0,k.Hs)(e),t,n,a,(0,z.zP)()).then((e=>e?(0,p.R9)({buffer:e,width:n,height:a}):Promise.resolve(null))).then((t=>(e instanceof q.GI&&this._makeEnqueuedRelease(t,(0,g.et)(e)),i.resolve(t),t))))),{promise:l,cancel:d}=this._requestQueue.enqueue(s,!1);return{promise:l,cancel:d}}async getAttachment(e){const[t,n]=await this.client.getAttachment(e);return new Blob([t],{type:n})}async parseXFDF(e,t){const{errors:n,formFieldValues:a,annotations:i}=await this.client.parseXFDF(e,t);return{errors:null==n?void 0:n.map((e=>({errorMessage:e.error_message,type:e.type}))),formFieldValues:null==a?void 0:a.reduce(((e,t)=>(e[t.fqdn]=t.values,e)),{}),annotations:(0,o.aV)((null==i?void 0:i.map((e=>(0,k.vH)((0,g.xc)(),e))))||[])}}async search(e,t,n,a){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:K.S.TEXT;const s=await this.client.search(e,t,n,a,o);return(0,P.E)(s.filter((e=>i||!e.isAnnotation)))}async searchAndRedact(e,t,n){const{totalPages:a}=n,i=await this.client.search(e,0,a,t.caseSensitive,t.searchType);return(0,o.aV)(i.filter((e=>t.searchInAnnotations||!e.isAnnotation)).map((e=>{const a=e.isAnnotation?[e.annotationRect]:e.rectsOnPage,i=(0,o.aV)(a).map((e=>((0,r.kG)(e),(0,Z.k)(e))));return new M.Z(re(re(re({},(0,g.lx)(n)),t.annotationPreset),{},{pageIndex:e.pageIndex,rects:i,boundingBox:N.Z.union(i)}))})))}async exportPDF(){let{flatten:e=!1,incremental:t,saveForPrinting:n=!1,format:a="pdf",excludeAnnotations:i=!1,preserveInstantJSONChanges:o=!0,permissions:s,outputFormat:l=!1,flattenElectronicSignatures:c=e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0;if(e&&!c)throw new r.p2("Cannot set `flattenElectronicSignatures` to `false` when `flatten` is set to `true`.");if(l&&"boolean"!=typeof l&&l.conformance&&(0,r.kG)(l.conformance&&Object.values(Y.w).includes(l.conformance),"The supplied PDF/A Conformance type is not valid. Valid Conformance should be one of the following options PSPDFKit.Conformance."+Object.keys(Y.w).join(", PSPDFKit.Conformance.")),void 0===t)if(this._state.features.includes($.q.DIGITAL_SIGNATURES)){const e=await this.getSignaturesInfo();t=!n&&Boolean("not_signed"!==e.status)}else t=!1;return this.client.exportFile(e,t,n,a,i,o,s,d).then((async e=>{let[t,n]=e;if(t.mimeType=n.mimeType,t.extension=n.extension,l){const e="boolean"!=typeof l&&l.conformance?l.conformance:Y.w.PDFA_2B;let n;try{return n=await this._setupGdPictureClient(),await n.toPdf(t,e)}finally{var a;null===(a=n)||void 0===a||a.destroy(),(0,te.Nt)(null)}}return t}))}async exportOffice(e){let t,{format:n}=e;try{const[e]=await this.client.exportFile(!1,!1,!1,"pdf",!1,!0);return t=await this._setupGdPictureClient(),await t.toOffice(e,n)}catch(e){throw new r.p2(`Exporting to ${n} failed: ${e.message}.`)}finally{var a;null===(a=t)||void 0===a||a.destroy(),(0,te.Nt)(null)}}async _setupGdPictureClient(){let e=(0,te.xE)();return e||(e=(0,te.Un)({baseUrl:this._state.baseProcessorEngineUrl,mainThreadOrigin:this._state.appName||(0,m.$u)()||window.location.origin,licenseKey:this._state.licenseKey,processorEngine:this._state.processorEngine,customFonts:this._state.customFonts,dynamicFonts:this._state.dynamicFonts,fontSubstitutions:this._state.fontSubstitutions}),(0,te.Nt)(e)),e}exportXFDF(e){return this.client.exportXFDF(e)}exportInstantJSON(e){return this.client.exportInstantJSON(e)}getPDFURL(){let{includeComments:e=!0,saveForPrinting:t,excludeAnnotations:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.generatePDFObjectURL({includeComments:e,saveForPrinting:t,excludeAnnotations:n})}generatePDFObjectURL(){let e,{includeComments:t=!0,saveForPrinting:n,excludeAnnotations:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!1;return{promise:new Promise((o=>{this.exportPDF({flatten:!0,includeComments:t,saveForPrinting:n,excludeAnnotations:a}).then((t=>{if(i)return;const n=new Blob([t],{type:t.mimeType});e=window.URL.createObjectURL(n),o(e)}))})),revoke:()=>{e&&window.URL.revokeObjectURL(e),i=!0}}}async getDocumentOutline(){const e=await this.client.getDocumentOutline();return(0,o.aV)(e.map(f.i))}async setDocumentOutline(e){return this.client.setDocumentOutline(e.map(f.a).toArray())}async getPageGlyphs(e){const t=await this.client.getPageGlyphs(e);return(0,k.Vl)(t)}async onKeystrokeEvent(e){return await this.client.onKeystrokeEvent(e)}async evalFormValuesActions(e){return this.client.evalFormValuesActions(e.map(k.kr).toJS())}async evalScript(e,t,n){return this.client.evalScript(e,t,n)}async setFormJSONUpdateBatchMode(e){return this.client.setFormJSONUpdateBatchMode(e)}async getMeasurementScales(){const e=await this.client.getMeasurementScales();return null==e?void 0:e.measurementContentFormats}async addMeasurementScale(e){return await this.client.addMeasurementScale(e)}async removeMeasurementScale(e){return await this.client.removeMeasurementScale(e)}async getAnnotationsByScale(e){return await this.client.getAnnotationsByScale(e)}async applyOperationsAndReload(e){try{const{processedOperations:t,operationsDocuments:n}=await he(e);await this.client.applyOperations(t,n)}catch(e){throw new r.p2(`Applying operations failed: ${e}`)}return this.provider._state=this.provider._state.set("alreadyLoadedPages",(0,o.D5)()),this.reloadDocument()}async applyRedactionsAndReload(){try{await this.client.applyRedactions()}catch(e){throw new r.p2(`Applying redactions failed: ${e}`)}return this.reloadDocument()}async reloadDocument(){try{var e;null===(e=this.provider)||void 0===e||e.destroy(),this.provider=new j(this.client,null),this._state=this._state.set("lazyLoadedPages",null);const t=await this.client.reloadDocument();return this._state=this._state.set("documentResponse",t).set("documentHandle",(parseInt(this._state.documentHandle)+1).toString()).set("signaturesInfoPromise",null),{features:this._state.features,signatureFeatureAvailability:this._state.signatureFeatureAvailability,hasPassword:!1,allowedTileScales:"all"}}catch(e){throw new r.p2(`Reloading failed: ${e}`)}}async getEmbeddedFiles(){const e=await this.client.getEmbeddedFilesList();return(0,o.aV)(e.map((e=>{let{id:t}=e,n=(0,a.Z)(e,oe);return(0,J.i)(t,n,!0)})))}async exportPDFWithOperations(e){try{const{processedOperations:t,operationsDocuments:n}=await he(e);return this.client.exportPDFWithOperations(t,n)}catch(e){throw new r.p2(`Exporting PDF with operations failed: ${e}`)}}async setSignaturesLTV(e){try{var t;const n=(null!=e?e:[]).map((e=>e instanceof ArrayBuffer?(0,B.sM)(e):d.Base64.encode(e))),a=await this.getRevocationResponses(n);if(null!==(t=(await this.client.setSignaturesLTV(a).then((e=>(0,k.rS)(e)))).signatures)&&void 0!==t&&t.find((e=>e.certificateChainValidationStatus===Q.wk.ok_but_could_not_check_revocation)))throw"Could not set LTV for all signatures. Check that the OCSP response is valid.";return this._state=this._state.set("signaturesInfoPromise",null),this.getSignaturesInfo()}catch(e){throw new r.p2(`Setting signatures LTV failed: ${e}`)}}getSignaturesInfo(){try{if(this._state.signaturesInfoPromise)return this._state.signaturesInfoPromise;const e=this.client.getSignaturesInfo().then((e=>(0,k.rS)(e)));return this._state=this._state.set("signaturesInfoPromise",e),e}catch(e){throw new r.p2(`Getting document signatures info: ${e}`)}}async refreshSignaturesInfo(){this._state=this._state.set("signaturesInfoPromise",null)}async loadCertificates(e){return this.client.loadCertificates(e)}async getRevocationResponses(e){const t=await this.client.getRevocationRequests(e);return await Promise.all(t.map((async e=>{let{method:t,url:n,content_type:a,request_data:i,token:o}=e;try{const e=await fetch(n,{method:t,headers:{"Content-Type":null!=a?a:"application/ocsp-request"},body:pe(i)}),s=await e.arrayBuffer();return{response_code:e.status,body:(0,B.sM)(s),token:o}}catch(e){return{response_code:0,body:"",token:o,error_message:e.message}}})))}async signDocumentAndReload(e,t){var n,a,i,o,s,l,c,u,m,h,p,f,g,y,b;(0,r.kG)(void 0===t||"function"==typeof t,"On a Standalone deployment, `twoStepSignatureCallbackOrSigningServiceData` must be a function if provided.");const v=null==e||null===(n=e.signingData)||void 0===n?void 0:n.certificates;(0,r.kG)(!(null!=e&&null!==(a=e.signingData)&&void 0!==a&&a.signatureType)||(null==e||null===(i=e.signingData)||void 0===i?void 0:i.signatureType)===Q.BG.CMS||Array.isArray(v)&&v.length>0,"For signatures of type `PSPDFKit.SignatureType.CAdES` an `Array` of certificates must be provided in `signaturePreparationData.signingData.certificates`."),(0,r.kG)(!(null!=e&&null!==(o=e.signingData)&&void 0!==o&&o.timestamp)||"string"==typeof(null==e||null===(s=e.signingData)||void 0===s||null===(s=s.timestamp)||void 0===s?void 0:s.url),"The `url` property of `signingData.timestamp` must be a string."),(0,r.kG)(!(null!=e&&null!==(l=e.signingData)&&void 0!==l&&l.timestamp&&null!=e&&null!==(c=e.signingData)&&void 0!==c&&null!==(c=c.timestamp)&&void 0!==c&&c.password&&"string"!=typeof(null==e||null===(u=e.signingData)||void 0===u||null===(u=u.timestamp)||void 0===u?void 0:u.password)),"The `password` property of `signingData.timestamp` must be a string."),(0,r.kG)(!(null!=e&&null!==(m=e.signingData)&&void 0!==m&&m.timestamp&&null!=e&&null!==(h=e.signingData)&&void 0!==h&&null!==(h=h.timestamp)&&void 0!==h&&h.username&&"string"!=typeof(null==e||null===(p=e.signingData)||void 0===p||null===(p=p.timestamp)||void 0===p?void 0:p.username)),"The `username` property of `signingData.timestamp` must be a string."),(0,r.kG)(void 0===(null==e||null===(f=e.signingData)||void 0===f?void 0:f.ltv)||"boolean"==typeof(null==e||null===(g=e.signingData)||void 0===g?void 0:g.ltv),"The `ltv` property of `signingData` must be a boolean if set.");const P=re(re({signatureType:(null==e||null===(y=e.signingData)||void 0===y?void 0:y.signatureType)||(Array.isArray(v)&&v.length>0?Q.BG.CAdES:Q.BG.CMS)},(null==e||null===(b=e.signingData)||void 0===b?void 0:b.certificates)&&{certificates:e.signingData.certificates.map((e=>e instanceof ArrayBuffer?(0,B.sM)(e):d.Base64.encode(e)))}),null!=e&&e.placeholderSize?{estimatedSize:e.placeholderSize}:null);try{var S,A,_;const{hash:n,signatureFormFieldName:a,file:i,fileContents:o,dataToBeSigned:s}=await this.client.prepareSign((0,k._L)(P),null!=e&&e.signatureMetadata?(0,k._D)(e.signatureMetadata):null,Boolean(null==e?void 0:e.flatten),null==e?void 0:e.formFieldName,(0,k.eE)(null==e?void 0:e.position),await(0,k.sr)(null==e?void 0:e.appearance)),l=function(e){const t=e.trim(),n=t.length/2,a=new Uint8Array(n);for(let e=0;e<n;e++)a[e]=parseInt(t.substr(2*e,2),16);return a}(s);let c,d,u;if(t){try{c=await t({hash:n,fileContents:o,dataToBeSigned:l})}catch(e){throw new r.p2(`\`twoStepSignatureCallback\` threw an error: ${e}`)}if(!(c instanceof ArrayBuffer))throw new r.p2(`The resolved value from \`twoStepSignatureCallback\` should be a an \`ArrayBuffer\` but is of type \`${typeof c}\` instead.`);u=c}else{if(null==e||!e.signingData||!e.signingData.privateKey)throw new r.p2("No `twoStepSignatureCallback` or `signingData.privateKey` was provided.");{const t={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"},modulusLength:2048,extractable:!1,publicExponent:new Uint8Array([1,0,1])},n=await globalThis.crypto.subtle.importKey("pkcs8",function(e){const t=e.split("\n");let n="";for(let e=0;e<t.length;e++)t[e].trim().length>0&&t[e].indexOf("-BEGIN RSA PRIVATE KEY-")<0&&t[e].indexOf("-BEGIN PRIVATE KEY-")<0&&t[e].indexOf("-BEGIN RSA PUBLIC KEY-")<0&&t[e].indexOf("-BEGIN CERTIFICATE-")<0&&t[e].indexOf("-END RSA PRIVATE KEY-")<0&&t[e].indexOf("-END PRIVATE KEY-")<0&&t[e].indexOf("-END RSA PUBLIC KEY-")<0&&t[e].indexOf("-END CERTIFICATE-")<0&&(n+=t[e].trim());return pe(n)}(e.signingData.privateKey),t,!0,["sign"]);d=await globalThis.crypto.subtle.sign(t,n,l),u=d}}const m=(0,B.sM)(u)||"";let h=null;const p=P.certificates||[];let f=[];if(null!=e&&null!==(S=e.signingData)&&void 0!==S&&S.ltv&&(f=await this.getRevocationResponses(p)),null!=e&&null!==(A=e.signingData)&&void 0!==A&&A.timestamp){const{url:t,username:n="",password:a=""}=e.signingData.timestamp,i=await this.client.getTimestampRequest(m,{url:t,username:n,password:a}),o={method:i.method,headers:{"Content-Type":i.contentType||"application/timestamp-query"},body:pe(i.requestData)};(i.username||i.password)&&(o.headers.Authorization=`Basic ${btoa(`${i.username}:${i.password}`)}`);try{const e=await fetch(i.url,o),t=await e.arrayBuffer();h={response_code:e.status,body:(0,B.sM)(t),token:i.token}}catch(e){h={response_code:0,body:"",token:i.token,error_message:e.message}}}const g=await this.client.sign(i,a,n,k.YA[P.signatureType],m,p,h,f);return null!=e&&null!==(_=e.signingData)&&void 0!==_&&_.ltv&&g.signature.certificateChainValidationStatus===Q.wk.ok_but_could_not_check_revocation&&(0,r.ZK)("Document signed, but couldn't add certificate revocation information so the signature may not be LTV-enabled."),await this.reloadDocument(),a}catch(e){throw await this.client.restoreToOriginalState(),e}}cancelRequests(){this._requestQueue.cancelAll()}async syncChanges(){}getDefaultGroup(){}isCollaborationPermissionsEnabled(){return!1}async clearAPStreamCache(){return this.client.clearAPStreamCache()}async setComparisonDocument(e,t){return this.client.setComparisonDocument(e,t)}async openComparisonDocument(e){return this._state=this._state.set("forceAnnotationsRender",!1),await this.client.closeDocument(),this._state=this._state.set("forceAnnotationsRender",!0),await this.client.openComparisonDocument(e)||this._state.documentResponse}async documentCompareAndOpen(e){return this.client.documentCompareAndOpen(e)}async persistOpenDocument(e){return this.client.persistOpenDocument(e)}async cleanupDocumentComparison(){return this.client.cleanupDocumentComparison()}async runPDFFormattingScripts(e,t){return this.client.runPDFFormattingScripts(e,t)}async runPDFFormattingScriptsFromWidgets(e,t,n){let a=[];if(this._isPDFJavaScriptEnabled){const{withAPStream:i,withoutAPStream:o}=e.reduce(((e,a)=>{if(a instanceof q.x_){if((null==t?void 0:t.get(a.formFieldName))instanceof q.Yo)return e;null!=n&&n(a)?e.withAPStream.push(a.formFieldName):e.withoutAPStream.push(a.formFieldName)}return e}),{withAPStream:[],withoutAPStream:[]});let s=[];if(i.length&&!o.length)s=await this.runPDFFormattingScripts(i,!0);else if(!i.length&&o.length)s=await this.runPDFFormattingScripts(o,!1);else if(i.length&&o.length){const[e,t]=await Promise.all([this.runPDFFormattingScripts(i,!0),this.runPDFFormattingScripts(o,!1)]);s=e.concat(t)}a=(0,V.gE)(this._initialChanges,s)}return a}setFontSubstitutions(e){return this.client.setFontSubstitutions(e)}async contentEditorReload(){return(0,r.kG)(this.provider instanceof j,"Standalone can only use standalone annotation provider"),this.provider._state=this.provider._state.set("alreadyLoadedPages",(0,o.D5)()),this.reloadDocument()}getOCGs(){return this.client.getOCGs()}getOCGVisibilityState(){return this.client.getOCGVisibilityState()}setOCGVisibilityState(e){return this.client.setOCGVisibilityState(e)}updateButtonIcon(e,t,n){return this.client.updateButtonIcon((0,k.Hs)(e),t,n)}}function ue(e){return{baseUrl:e.baseUrl,baseCoreUrl:e.baseCoreUrl,baseProcessorEngineUrl:e.baseProcessorEngineUrl,licenseKey:e.licenseKey,document:e.document,disableWebAssemblyStreaming:!!e.disableWebAssemblyStreaming,enableAutomaticLinkExtraction:!!e.enableAutomaticLinkExtraction,overrideMemoryLimit:"number"==typeof e.overrideMemoryLimit?e.overrideMemoryLimit:null,documentHandle:"number"==typeof e.documentHandle?e.documentHandle:"0",trustedCAsCallback:"function"==typeof e.trustedCAsCallback?e.trustedCAsCallback:null,customFonts:Array.isArray(e.customFonts)?e.customFonts.filter((e=>e instanceof H.Z)):null,forceLegacySignaturesFeature:Boolean(e.forceLegacySignaturesFeature),appName:"string"==typeof e.appName?e.appName:null,productId:e.productId,processorEngine:e.processorEngine,dynamicFonts:e.dynamicFonts,fontSubstitutions:e.fontSubstitutions,inlineWorkers:e.inlineWorkers}}function me(e){const{licenseKey:t,instantJSON:n,XFDF:a,disableWebAssemblyStreaming:i,disableIndexedDBCaching:o,enableAutomaticLinkExtraction:s,overrideMemoryLimit:l,standaloneInstancesPoolSize:c,trustedCAsCallback:d,baseUrl:u,baseCoreUrl:m,baseProcessorEngineUrl:h,customFonts:p,isSharePoint:f,isSalesforce:g,dynamicFonts:y,inlineWorkers:b}=e;if((0,r.kG)("string"==typeof u,"`baseUrl` is mandatory and must be a valid URL, e.g. `https://example.com/"),(0,W.Pn)(u),(0,r.kG)(!m||"string"==typeof m,"`baseCoreUrl` must be a valid URL if set, e.g. `https://example.com/"),m&&(0,W.rH)(m),(0,r.kG)(!h||"string"==typeof h,"`baseProcessorEngineUrl` must be a valid URL if set, e.g. `https://example.com/"),h&&(0,W.qH)(h),(0,r.kG)(null==t||"string"==typeof t,"licenseKey must be a string value if provided. Please obtain yours from https://customers.pspdfkit.com."),"string"==typeof t&&(0,r.kG)(!t.startsWith("TRIAL-"),"You're using the npm key instead of the license key. This key is used to download the PSPDFKit for Web package via the node package manager.\n\nLeave out the license key to activate as a trial."),(0,r.kG)(void 0===a||"string"==typeof a,"XFDF must be a string"),n&&((0,r.Ou)(n),(0,r.kG)(void 0===a,"Cannot import from both instantJSON and XFDF")),(0,r.kG)(void 0===i||"boolean"==typeof i,"disableWebAssemblyStreaming must be a boolean"),(0,r.kG)(void 0===s||"boolean"==typeof s,"enableAutomaticLinkExtraction must be a boolean"),(0,r.kG)(void 0===l||"number"==typeof l,"overrideMemoryLimit must be a number"),(0,r.kG)(void 0===c||"number"==typeof c&&c>=0,"standaloneInstancesPoolSize must be a non-negative number"),(0,r.kG)(void 0===d||"function"==typeof d,"trustedCAsCallback must be a function"),(0,r.kG)(void 0===p||Array.isArray(p)&&p.every((e=>e instanceof H.Z)),"customFonts must be an array of PSPDFKit.Font instances"),(0,r.kG)(void 0===p||p.every((e=>e.callback)),"All PSPDFKit.Font instances specified on customFonts must have its callback property defined"),void 0!==o&&(0,r.a1)("disableIndexedDbCaching has been deprecated and it no longer has effect. It will be removed in a later version.\nBrowsers dropped IndexedDB serialization of Wasm modules in favor of regular HTTP caching."),(f||g)&&(0,r.a1)("isSharePoint and isSalesforce configuration properties are deprecated and will be removed in the next major release. Please use the new Configuration#productId property instead. For more information, please check the migration guide."),(0,r.kG)(!(f&&g),"You cannot enable both SharePoint and Salesforce integrations at the same time. Please set either isSharePoint or isSalesforce to true, but not both."),"string"==typeof y)try{new URL(y)}catch(e){throw new r.p2("dynamicFonts must be a valid URL to a JSON file containing the data for fonts to be dynamically loaded.")}(0,r.kG)(void 0===b||"boolean"==typeof b,"inlineWorkers must be a boolean")}async function he(e){const t=new WeakMap,n={};return{processedOperations:await Promise.all(e.map((async(e,a)=>{if("importDocument"===e.type){const{document:i}=e;return(0,r.kG)(i instanceof File||i instanceof Blob,"Wrong `importDocument` operation `document` value: it must be a File or a Blob"),(0,U.M)(t,n,i,e,a,"document")}if("applyInstantJson"===e.type){const i=e.instantJson;(0,r.kG)("object"==typeof i&&null!==i,"Wrong `applyInstantJson` operation `instantJson` value: it must be an object");const o=JSON.stringify(i),s=new Blob([o],{type:"application/json"});return(0,U.M)(t,n,s,e,a,"dataFilePath")}if("applyXfdf"===e.type){const i=e.xfdf;(0,r.kG)("string"==typeof i,"Wrong `applyXfdf` operation `xfdf` value: it must be a string");const o=new Blob([i],{type:"application/vnd.adobe.xfdf"});return(0,U.M)(t,n,o,e,a,"dataFilePath")}return e}))),operationsDocuments:n}}function pe(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n.buffer}},67055:(e,t,n)=>{n.d(t,{i:()=>r});var a=n(35369);class i extends(a.WV({id:"",attachmentId:"",description:null,fileName:null,fileSize:null,updatedAt:null})){}var o=n(34923);function s(e,t){return t}function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s(0,n)?new i({id:(0,o.C)(),description:t.fileDescription,attachmentId:e,fileName:t.fileName||null,fileSize:t.fileSize||null,updatedAt:t.modificationDate?new Date(t.modificationDate):null}):new i({id:e,description:t.description,attachmentId:t.fileAttachmentId,fileName:t.fileName||null,fileSize:t.fileSize||null,updatedAt:new Date(t.updatedAt)||null})}},7407:(e,t,n)=>{n.d(t,{a:()=>l,i:()=>c});var a=n(15359),i=n(35369),o=n(96029),s=n(74751),r=n(45249);function l(e){return{type:"pspdfkit/outline-element",children:e.children&&e.children.map((e=>l(e))).toJS(),title:e.title,color:e.color&&(0,s.C)(e.color),isBold:e.isBold,isItalic:e.isItalic,isExpanded:e.isExpanded,action:e.action&&(0,o.vP)(e.action)}}function c(e){let t,n;(0,a.kG)("pspdfkit/outline-element"===e.type,"invalid outline element type."),(0,a.kG)(null==e.children||Array.isArray(e.children),"children must be an Array<OutlineElement>."),(0,a.kG)("string"==typeof e.title,"title must be a string."),(0,a.kG)(null==e.isBold||"boolean"==typeof e.isBold,"isBold must be a boolean."),(0,a.kG)(null==e.isItalic||"boolean"==typeof e.isItalic,"isItalic must be a boolean."),(0,a.kG)(null==e.isExpanded||"boolean"==typeof e.isExpanded,"isExpanded must be a boolean.");try{t=e.action&&(0,o.lk)(e.action)}catch(t){(0,a.ZK)(`PDF Action not supported ${JSON.stringify(e.action)})`)}try{n=e.color&&(0,s.b)(e.color)}catch(t){(0,a.ZK)(`Invalid color:\n\n${e.color}`)}const l={title:e.title,color:n,isBold:!0===e.isBold,isItalic:!0===e.isItalic,isExpanded:!0===e.isExpanded,action:t,children:(0,i.aV)()};return e.children&&e.children.length>0&&(l.children=(0,i.aV)(e.children.map(c))),new r.sT(l)}},88265:(e,t,n)=>{n.d(t,{M:()=>s});var a=n(96156);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n,a,i,s){let r;return e.has(n)?r=e.get(n):(r=i.toString(),t[r]=n,e.set(n,r)),o(o({},a),{},{[s]:r})}},84254:(e,t,n)=>{n.d(t,{E:()=>r});var a=n(35369),i=n(15359),o=n(98492),s=n(68804);function r(e){return(0,i.kG)(Array.isArray(e),"Wrong `json` field"),(0,a.aV)(e.map((e=>((0,i.kG)("number"==typeof e.pageIndex,"Wrong `pageIndex` field"),(0,i.kG)("string"==typeof e.previewText,"Wrong `previewText` field"),(0,i.kG)(Array.isArray(e.rangeInPreview),"Wrong `rangeInPreview` field"),(0,i.kG)(Array.isArray(e.rectsOnPage),"Wrong `rectsOnPage` field"),new s.Z({pageIndex:e.pageIndex,previewText:e.previewText,locationInPreview:e.rangeInPreview[0],lengthInPreview:e.rangeInPreview[1],rectsOnPage:(0,a.aV)(e.rectsOnPage).map((e=>(0,o.k)(e))),isAnnotation:!!e.isAnnotation,annotationRect:e.annotationRect?(0,o.k)(e.annotationRect):null})))).filter(Boolean))}}}]);